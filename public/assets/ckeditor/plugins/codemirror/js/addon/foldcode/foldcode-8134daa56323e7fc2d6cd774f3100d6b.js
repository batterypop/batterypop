CodeMirror.tagRangeFinder=function(e,r){for(var n=RegExp("^[A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*"),o=e.getLine(r.line),u=!1,i=null,t=r.ch;!u;){if(t=o.indexOf("<",t),-1==t)return;if(t+1<o.length&&"/"==o[t+1])t++;else if(o.substr(t+1).match(n)){var l=o.indexOf(">",t+1);if(-1==l){for(var u=r.line+1,f=!1,F=e.lineCount();F>u&&!f;){var a=e.getLine(u),l=a.indexOf(">");if(-1!=l&&(f=!0,a=a.lastIndexOf("/",l),-1!=a&&l>a&&(a=o.substr(a,l-a+1),!a.match(/\/\s*\>/))))return;u++}u=!0}else F=o.lastIndexOf("/",l),-1==F?u=!0:(a=o.substr(F,l-F+1),a.match(/\/\s*\>/)||(u=!0));u&&((i=o.substr(t+1).match(n))?(i=i[0],-1!=o.indexOf("</"+i+">",t)&&(u=!1)):u=!1),u||t++}else t++}if(u)for(n=RegExp("(\\<\\/"+i+"\\>)|(\\<"+i+"\\>)|(\\<"+i+"\\s)|(\\<"+i+"$)"),i="</"+i+">",t=1,u=r.line+1,F=e.lineCount();F>u;){if(o=e.getLine(u),o=o.match(n))for(f=0;f<o.length;f++)if(o[f]==i?t--:t++,!t)return{from:CodeMirror.Pos(r.line,l+1),to:CodeMirror.Pos(u,o.index)};u++}},CodeMirror.braceRangeFinder=function(e,r){for(var n,o,u=r.line,i=e.getLine(u),t=i.length;t=i.lastIndexOf("{",t),!(t<r.ch);){if(o=e.getTokenAt(CodeMirror.Pos(u,t+1)).type,!/^(comment|string)/.test(o)){n=t;break}t-=1}if(!(null==n||i.lastIndexOf("}")>n)){var l,f,i=1,t=e.lineCount(),F=u+1;e:for(;t>F;++F)for(var a=e.getLine(F),d=0;;){var s=a.indexOf("{",d),d=a.indexOf("}",d);if(0>s&&(s=a.length),0>d&&(d=a.length),d=Math.min(s,d),d==a.length)break;if(e.getTokenAt(CodeMirror.Pos(F,d+1)).type==o)if(d==s)++i;else if(!--i){l=F,f=d;break e}++d}if(null!=l&&l!=u+1)return{from:CodeMirror.Pos(u,n+1),to:CodeMirror.Pos(l,f)}}},CodeMirror.indentRangeFinder=function(e,r){for(var n=e.getOption("tabSize"),o=e.getLine(r.line),u=CodeMirror.countColumn(o,null,n),i=r.line+1,t=e.lineCount();t>i;++i){var l=e.getLine(i);if(CodeMirror.countColumn(l,null,n)<u&&CodeMirror.countColumn(e.getLine(i-1),null,n)>u)return{from:CodeMirror.Pos(r.line,o.length),to:CodeMirror.Pos(i,l.length)}}},CodeMirror.newFoldFunction=function(e,r){if(null==r&&(r="â†”"),"string"==typeof r){var n=document.createTextNode(r),r=document.createElement("span");r.appendChild(n),r.className="CodeMirror-foldmarker"}return function(n,o){"number"==typeof o&&(o=CodeMirror.Pos(o,0));var u=e(n,o);if(u){for(var i=n.findMarksAt(u.from),t=0,l=0;l<i.length;++l)i[l].__isFold&&(++t,i[l].clear());if(!t){i=r.cloneNode(!0),CodeMirror.on(i,"mousedown",function(){f.clear()});var f=n.markText(u.from,u.to,{replacedWith:i,clearOnEnter:!0,__isFold:!0})}}}};