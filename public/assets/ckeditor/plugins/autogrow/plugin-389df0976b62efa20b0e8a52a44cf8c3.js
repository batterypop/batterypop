!function(){function e(e){var t=e.getStyle("overflow-y"),o=e.getDocument(),n=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",o);o[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(n);var i=n.getDocumentPosition(o).y+n.$.offsetHeight;return n.remove(),e.setStyle("overflow-y",t),i}function t(e){var t=e.document,o=t.getBody(),n=t.getDocumentElement();return"BackCompat"==t.$.compatMode?o:n}var o=function(o){if(o.window){var n=o.getCommand("maximize");if(!n||n.state!=CKEDITOR.TRISTATE_ON){var i=t(o),a=o.window.getViewPaneSize().height,r=e(i);r+=o.config.autoGrow_bottomSpace||0;var m=void 0!=o.config.autoGrow_minHeight?o.config.autoGrow_minHeight:200,d=o.config.autoGrow_maxHeight||1/0;r=Math.max(r,m),r=Math.min(r,d),r!=a&&(r=o.fire("autoGrow",{currentHeight:a,newHeight:r}).newHeight,o.resize(o.container.getStyle("width"),r,!0)),i.$.scrollHeight>i.$.clientHeight&&d>r?i.setStyle("overflow-y","hidden"):i.removeStyle("overflow-y")}}};CKEDITOR.plugins.add("autogrow",{init:function(e){e.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&e.on("instanceReady",function(){var n=e.editable();if(n.isInline())e.ui.space("contents").setStyle("height","auto");else{e.addCommand("autogrow",{exec:o,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var i={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};for(var a in i)e.on(a,function(e){"wysiwyg"==e.editor.mode&&setTimeout(function(){o(e.editor),o(e.editor)},100)});e.on("afterCommandExec",function(n){if("maximize"==n.data.name&&"wysiwyg"==n.editor.mode)if(n.data.command.state==CKEDITOR.TRISTATE_ON){var i=t(e);i.removeStyle("overflow")}else o(e)}),e.config.autoGrow_onStartup&&e.execCommand("autogrow")}})}})}();